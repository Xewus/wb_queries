# wb_queries (test task)
Бот получает данные с маркетплейса **Wildberries**.
***
# Task
Написать телеграм бота, который принимает от пользователя поисковый запрос и номенклатуру(артикул товара),  в ответ получает сообщение. Бот парсит данные с www.wildberries.ru. Если товар находится на первых 100 страницах поиска, присылаете сообщение с номером страницы и позиции, если нет, то любое текстовое сообщение. 

Стек: Python(3.9 и выше), aiogram, aiohttp/requests, docker(по желанию)

Дополнительные задания:
1) Добавить получение результатов в зависимости от пункта выдачи заказов клиента.

Пример сообщения пользователя:

37260674 Омега 3
***
### Мысли вслух
- Несмотря на возможное наличие десятков тысяч товаров по какому-то запросу, `Wildberries` не отдаёт больше 60 страниц даже для простого просмотра в браузере.
- Возможно, что некоторые под теримном "парсинг" понимают загрузку страниц и обыск их такими инструментами, как например, **Selenium** или **Scrapy**(к которому тоже придётся прикурить что-то для обработки JS).  
К данной задаче применять их кажется непривлекательным подходом. На загрузку одной страницы требуется несколько десятков запросов, до то того момента, когда JS затребует нужную информацию. В тоже время, если разобрать работу страницы, можно найти точку, куда отправляет запросы JS, что и осуществлено. Выгоды такого решения очевидны - в десятки раз меньше запросов, меньше нагрузки, меньшая вероятность бана.
- Запросы от пользователя.  
Несложно обработать запрос указанный в задании, хоть регуляркой, хоть сплитом. Проблемы начинаются при добавлении адреса.  
Например: `123456 деревянный клин`, это поиск по запросу `деревянный` в городе `Клин` или  просто запрос `деревянный клин` в дефолт-сити???  
Для решения данной проблемы изменён ввод, пользователь вводит последовательно *артикул* > *поисковый запрос* > *адрес*.
***
### Инструкция по использованию

1. Если у Вас есть **Docker**.

Скачать и запустить образ (108 МВ):
```
sudo docker run -e "BOT_TOKEN=<Токен Вашего бота>
```
2. Если у Вас не есть **Docker**.
Создать директорию для приложения и перейти в неё:
```
mkdir wb_bot && cd wb_bot
```
Скачать код с Githab:
```
git@github.com:Xewus/wb_queries.git
```
Переименовать файд `.env.example` в `.env` и вписать в него нужные данные.

Установить зависимости:
```
pip3 install -U pip && pip install -r /app/requirements.txt --no-cache-dir
```
Запустить бота:
```
python3 start_app.py
```
